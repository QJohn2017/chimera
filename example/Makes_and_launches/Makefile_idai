PGM = fPlares

SRC_common = ./src/fields.f90      ./src/maxwell_pic.f90  \
             ./src/pushers.f90     ./src/particle_subs.f90 \
             ./src/utils.f90       ./src/spectrum_calc.f90 \
             ./src/maxwell_fel.f90 

FFTWIG = /home/sources/magins/andriyash/CODES/DEV/fft_gfort/include
FFTWLG = /home/sources/magins/andriyash/CODES/DEV/fft_gfort/lib
FFTWII = /home/sources/magins/andriyash/CODES/fftw/include
FFTWLI = /home/sources/magins/andriyash/CODES/fftw/lib

FLAGS_G = -c --opt='-g3 -fbounds-check -fimplicit-none -Wall -fbacktrace -finit-real=nan \
                    -lfftw3 -lm -I$(FFTWIG)' -L$(FFTWLG) -lm -lfftw3
FLAGS_I = -c --fcompiler=intelem --opt='-fast -O3 -us -axSSE4.1 -msse4.1 -pthread \
          -unroll-aggressive -I$(FFTWII) -lm -lfftw3' -L$(FFTWLI) -lm -lfftw3
F90 = f2py

# This is done when typing 'make gfortran' or simply 'make' (default behavior)
gfortran :
	$(F90) $(FLAGS_G) -m $(PGM) $(SRC_common)
	mv *.so ./moduls/

# This is done when typing 'make ifort'
ifort :
	$(F90) $(FLAGS_I) -m $(PGM) $(SRC_common)
	mv *.so ./moduls/

clean :
	rm -f  ./moduls/*.so ./moduls/*.pyc ./src/*.pyc ./*.pyc ./moduls/.nfs0* ./.nfs0*
